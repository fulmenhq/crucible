# v0.4.5 Release Notes

**Release Date**: 2026-01-10

## Summary

This release introduces the TUI Design System - a layered schema architecture for terminal UI theming - alongside the Standards Discoverability Architecture that improves how developers find applicable standards.

## TUI Design System Schemas

A new `schemas/design/` directory provides comprehensive schemas for terminal UI theming with a layered architecture separating semantic vocabulary from implementation details.

### Architecture

```
schemas/design/
├── core/v1.0.0/           # Shared semantic vocabulary
│   ├── semantic-colors.schema.json
│   ├── spacing-scale.schema.json
│   ├── typography-roles.schema.json
│   └── component-states.schema.json
└── tui/v1.0.0/            # Terminal implementation
    ├── theme.schema.json          # Root composition
    ├── color-palette.schema.json
    ├── typography.schema.json
    ├── layout.schema.json
    └── component.schema.json
```

### Core Schemas (Shared Vocabulary)

The core schemas define implementation-agnostic semantic vocabulary that can be shared across TUI and future web implementations:

| Schema             | Purpose                                                                                   |
| ------------------ | ----------------------------------------------------------------------------------------- |
| `semantic-colors`  | Color roles (primary, secondary, success, warning, error) with WCAG contrast requirements |
| `spacing-scale`    | Spacing tokens (xs through xl) with responsive tier definitions                           |
| `typography-roles` | Text roles (headline, body, caption, code) with weight and emphasis                       |
| `component-states` | UI states (default, hover, focus, active, disabled) with ARIA mappings                    |

### TUI Schemas (Terminal Implementation)

The TUI schemas implement the core vocabulary for terminal environments:

| Schema          | Purpose                                                                 |
| --------------- | ----------------------------------------------------------------------- |
| `theme`         | Root composition aggregating all schemas with metadata and requirements |
| `color-palette` | Terminal colors with capability-based fallback chains                   |
| `typography`    | Character set support, box drawing, glyphs, CJK width handling          |
| `layout`        | Cell-based dimensions, responsive breakpoints, ribbons/panels           |
| `component`     | Widget patterns with state styling, extensible for custom components    |

### Key Features

**Terminal Color Fallbacks**

```yaml
foreground:
  truecolor: "#7AA2F7" # 24-bit color
  ansi256: 111 # 256-color palette
  ansi16: "bright-blue" # 16-color name
  basic: "default" # No-color fallback
```

**Character Set Degradation**

- `unicode-full` → `unicode-basic` → `extended-ascii` → `ascii`
- Box drawing sets: rounded, single, double, ascii
- Glyph fallbacks: Nerd Font → Unicode → ASCII

**WCAG Accessibility**

- `wcag_contrast_ratio` field on color definitions
- `accessibility` section in themes for conformance level (A, AA, AAA)
- `focus_visible_required` and `motion_reduced` preferences

**CJK Support**

- `cjk_handling.width_mode`: narrow, wide, ambiguous-narrow, ambiguous-wide
- `emoji_width`: 1 or 2 cells
- Per-terminal calibration support

### Reference Themes

Three production-ready themes in `examples/design/tui/v1.0.0/themes/`:

| Theme                | Mode  | Color Min | WCAG Level | Notes                                       |
| -------------------- | ----- | --------- | ---------- | ------------------------------------------- |
| `dark.yaml`          | Dark  | 256-color | AA         | Tokyo Night-inspired, Nerd Font recommended |
| `light.yaml`         | Light | 256-color | AA         | Balanced daytime palette                    |
| `high-contrast.yaml` | Dark  | 16-color  | AAA        | ASCII-safe, maximum accessibility           |

### Schema Fixtures

Validation test fixtures in `examples/design/tui/v1.0.0/`:

**Valid** (`valid/`):

- `theme.minimal.yaml` - Minimum required fields
- `color-palette.minimal.yaml` - Color palette only
- `layout.minimal.yaml` - Layout configuration only

**Invalid** (`invalid/`):

- `theme.missing-metadata.yaml` - Missing required metadata
- `theme.invalid-version.yaml` - Bad version format
- `color-palette.invalid-hex.yaml` - Invalid hex color patterns
- `color-palette.invalid-ansi16.yaml` - Invalid ANSI 16 color name
- `layout.invalid-breakpoint.yaml` - Invalid tier enum value
- `layout.missing-breakpoints.yaml` - Missing required field

### Helper Library Integration

Themes will be accessible via helper libraries:

```go
// Go (gofulmen)
theme, _ := crucible.DesignRegistry.TUI().Theme("fulmen-dark")
primaryColor := theme.Colors.SemanticColors.Primary.Foreground.Truecolor
```

```typescript
// TypeScript (tsfulmen)
const theme = design.tui().theme("fulmen-dark");
const primaryColor = theme.colors.semanticColors.primary.foreground.truecolor;
```

### Future: Web Implementation

The architecture reserves `schemas/design/web/` for future web implementation schemas. Core vocabulary will be shared, with web-specific schemas adding:

- CSS color formats (oklch, hsl)
- Fluid typography (clamp, viewport units)
- Pixel/rem/em units
- Font stacks, variable fonts

---

## Standards Discoverability Architecture

Establishes guides as compliance routing documents that direct developers (human and AI) to applicable standards before implementation.

### Work-Type Routing

AGENTS.md now includes a routing table mapping work types to required reading:

| Work Type   | Guide                        | Standards Applied                  |
| ----------- | ---------------------------- | ---------------------------------- |
| HTTP server | http-server-patterns.md      | http-rest-standards, coding/{lang} |
| HTTP client | http-client-patterns.md      | http-rest-standards, coding/{lang} |
| CLI command | language-testing-patterns.md | portable-testing-practices         |
| Fixture     | fixture-standard.md          | http-server-patterns               |
| Schema      | schema-normalization.md      | frontmatter-standard               |
| Release     | release-checklist.md         | repository-versioning              |

### Testing Guides

New `docs/guides/testing/` family:

- `README.md` - Index explaining standards vs guides distinction
- `http-server-patterns.md` - Server/fixture patterns with compliance requirements
- `http-client-patterns.md` - Client testing with fixture usage patterns

### HTTP Server Anti-Patterns (Go)

Derived from 25+ lint fixes during rampart/gauntlet fixture development:

- `json.Encoder.Encode()` error handling after `WriteHeader()`
- Response body close patterns with per-file test helpers
- Context-aware delay handlers (no bare `time.Sleep()`)
- Body limits with `io.LimitReader` for DoS prevention

---

## UX Developer Role

New `uxdev` agentic role for frontend development (`config/agentic/roles/uxdev.yaml`):

**TUI Frameworks**: tview (Go), textual (Python), ink/opentui (Node), ratatui (Rust)
**Web Frameworks**: React, Vue, Svelte, HTMX
**Focus**: Accessibility-first with WCAG 2.1 AA compliance

---

## Migration Guide

### For Theme Consumers

1. Add theme schema reference to YAML files:

   ```yaml
   $schema: https://schemas.fulmenhq.dev/crucible/design/tui/v1.0.0/theme.schema.json
   ```

2. Implement terminal capability detection for fallback selection
3. Use semantic color roles instead of hardcoded values

### For Helper Libraries

1. Add `DesignRegistry.TUI().Theme(name)` API
2. Implement color fallback resolution based on terminal capability
3. Add glyph fallback resolution (Nerd Font → Unicode → ASCII)

---

## Breaking Changes

None in this release.

## Deprecations

None in this release.

## Known Issues

None at release time.
