# Crucible v0.4.2 Release Notes

**Release Date**: 2026-01-07
**Type**: Minor release (contains breaking change)

## Summary

This release establishes the Canonical URI Resolution Standard for schema identifiers and introduces the Fixture Standard for test infrastructure repositories. It also includes a fix for Python exit codes codegen path alignment.

## Breaking Changes

### Schema $id Canonical URIs

All crucible-hosted schemas now use module-qualified URIs:

```
# Old (v0.4.1 and earlier)
https://schemas.fulmenhq.dev/<topic>/<version>/<filename>

# New (v0.4.2+)
https://schemas.fulmenhq.dev/crucible/<topic>/<version>/<filename>
```

**Impact**: ~63 schemas updated. Libraries with offline `$ref` resolution must update their resolvers.

**Resolver Fix**: When mapping URLs to embedded paths, strip the `crucible/` prefix:
- URL path: `/crucible/library/foundry/v1.0.0/exit-codes.schema.json`
- Embedded path: `schemas/library/foundry/v1.0.0/exit-codes.schema.json`

See `.plans/memos/libraries/20260106-schema-id-updates.md` for migration guidance.

## Changes

### Added

#### Fixture Standard

New repository category and comprehensive standard for test infrastructure:

- **Standard Document**: `docs/architecture/fulmen-fixture-standard.md`
- **Fixture Catalog**: `config/taxonomy/fixture-catalog.yaml` - Registry for fixture names
- **Catalog Schema**: `schemas/taxonomy/fixture/v1.0.0/fixture-catalog.schema.json`
- **Category Standards**: `docs/standards/repository-category/fixture/README.md`

**Naming Pattern**: `fixture-<mode>-<category>-<name>-<variant>`

| Component | Values | Example |
|-----------|--------|---------|
| mode | `server`, `client`, `datastore`, `identity`* | `server` |
| category | `proving`, `utility`, `chaos` | `proving` |
| name | Registered in catalog, ASCII `[a-z][a-z0-9]` | `gauntlet` |
| variant | 3-digit zero-padded, `001` = reference | `001` |

*`identity` mode planned for v0.4.3

**Full Example**: `fixture-server-proving-gauntlet-001`

**Key Features**:
- Fixtures are real implementations with test-purpose data (NOT mocks)
- Container-first: `docker compose up` as primary entry
- Scenario-driven configuration (YAML/JSON)
- Required `INTEGRATION.md` documenting external dependencies
- i18n support for fixture metadata
- Standard environment variables (PORT, LOG_LEVEL, OIDC_ISSUER, etc.)
- Health check contract (`/health`, `/health/ready`)

**Initial Catalog Entries**:

| Name | Mode | Category | Description |
|------|------|----------|-------------|
| gauntlet | server | proving | Protected backend with mixed auth requirements |
| echo | server | utility | Simple request echo server |
| bucket | datastore | utility | S3-compatible object storage |
| gremlin | server | chaos | Failure injection for resilience testing |

#### Doc-Host Category

New repository category for path-addressed documentation hosting:

- `docs/standards/repository-category/doc-host/README.md`
- Complements spec-host (self-describing specs with `$id`)
- For Markdown docs, YAML configs, reference data

#### Canonical URI Resolution Standard

- `docs/standards/publishing/canonical-uri-resolution.md`
- Defines module-qualified URI pattern for schema identifiers
- Enables multi-repo schema hosting without namespace collisions

### Changed

#### Repository Categories Taxonomy

- Version: `2026.01.1`
- Added `fixture` category with full specification
- Added `doc-host` category
- Updated `schemas/taxonomy/repository-category/v1.0.0/category-key.schema.json`

### Removed

#### Enact Schemas (11 files)

Moved to enacthq organization:
- `schemas/enact/v1.0.0/*.schema.json`

#### Goneat Schemas (6 files)

Moved to goneat repository:
- `schemas/config/goneat/*.yaml`
- `schemas/tooling/goneat-tools/*.schema.json`

### Fixed

#### Python Exit Codes Path Alignment

Fixed codegen output path for Python exit codes:

| Before | After |
|--------|-------|
| `lang/python/src/pyfulmen/foundry/` | `lang/python/src/crucible/foundry/` |

Aligns with pattern used by other Python modules (`fulencode`, `fulhash`, `fulpack`).

## Commits

```
bb211a3 feat(schemas): implement canonical URI resolution with crucible module prefix
bb6917f fix(codegen): align Python exit codes path with other modules
fd997c2 refactor(foundry): relocate similarity module to standalone path
(additional commits for fixture standard)
```

## Impact

### For All Helper Libraries

1. **Sync crucible v0.4.2** to get updated schema `$id` values
2. **Check for hardcoded URIs**: `grep -r "schemas.fulmenhq.dev" --include="*.go" --include="*.ts" --include="*.py" --include="*.rs"`
3. **Update resolver** (if doing offline `$ref` resolution) to strip `crucible/` prefix

### For Libraries with Schema Validators (rsfulmen, etc.)

The embedded schema path does NOT include the `crucible/` prefix:
- `$id`: `https://schemas.fulmenhq.dev/crucible/library/foundry/v1.0.0/exit-codes.schema.json`
- Embedded: `schemas/library/foundry/v1.0.0/exit-codes.schema.json`

Update resolver to strip `crucible/` from URL path when looking up embedded schemas.

### For pyfulmen

Update imports:
```python
# Before
from pyfulmen.foundry.exit_codes import EXIT_CODES

# After
from crucible.foundry.exit_codes import EXIT_CODES
```

### For Fixture Implementers

New repositories implementing test fixtures should:
1. Register fixture name in `config/taxonomy/fixture-catalog.yaml` (PR to crucible)
2. Follow naming pattern: `fixture-<mode>-<category>-<name>-<variant>`
3. Include required `INTEGRATION.md` from template
4. Implement health check contract
5. Use scenario-driven configuration

## Upgrade Notes

1. This is a **breaking change** for schema `$id` resolution
2. Sync crucible before updating helper library versions
3. Run tests after sync to verify schema resolution works
4. Fixture standard is `draft` status - refinements expected in v0.4.3

## Cross-References

- [Canonical URI Resolution Standard](../docs/standards/publishing/canonical-uri-resolution.md)
- [Fulmen Fixture Standard](../docs/architecture/fulmen-fixture-standard.md)
- [Fixture Catalog](../config/taxonomy/fixture-catalog.yaml)
- [Library Migration Memo](../.plans/memos/libraries/20260106-schema-id-updates.md)
- [v0.4.1 Release Notes](v0.4.1.md)
- [v0.4.2 Feature Brief - URI Resolution](../.plans/active/v0.4.2/canonical-uri-resolution-feature-brief.md)
- [v0.4.2 Feature Brief - Fixtures](../.plans/active/v0.4.2/fixture-standard-feature-brief.md)
