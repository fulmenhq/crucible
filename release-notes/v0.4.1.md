# Crucible v0.4.1 Release Notes

**Release Date**: 2026-01-06
**Type**: Patch release

## Summary

This patch release completes the v0.4.0 similarity module promotion by physically relocating files from `library/foundry/` to `library/similarity/`, and fixes the Python exit codes codegen path to align with other language wrappers.

## Changes

### Changed

#### Similarity File Relocation

Moved all similarity-related files from foundry namespace to standalone similarity namespace:

| Before (v0.4.0)                                         | After (v0.4.1)                                             |
| ------------------------------------------------------- | ---------------------------------------------------------- |
| `config/library/foundry/similarity-fixtures.yaml`       | `config/library/similarity/fixtures.yaml`                  |
| `schemas/library/foundry/v1.0.0/similarity.schema.json` | `schemas/library/similarity/v1.0.0/similarity.schema.json` |
| `schemas/library/foundry/v2.0.0/similarity.schema.json` | `schemas/library/similarity/v2.0.0/similarity.schema.json` |
| `docs/standards/library/foundry/similarity.md`          | `docs/standards/library/similarity/similarity.md`          |

**Why**: v0.4.0 promoted similarity from a foundry catalog to a standalone platform module in the registry, but the physical files remained under `foundry/`. This caused confusion for gofulmen (which embeds crucible) and other consumers expecting paths to match the module structure.

#### Schema $id Updates

Updated schema `$id` to reflect new namespace:

- **v1.0.0**: `https://schemas.fulmenhq.dev/library/similarity/v1.0.0/similarity.schema.json`
- **v2.0.0**: `https://schemas.fulmenhq.dev/library/similarity/v2.0.0/similarity.schema.json`

#### Go Config API

Added new accessor for similarity fixtures:

```go
// New (preferred)
data, err := ConfigRegistry.Library().Similarity().Fixtures()

// Old (deprecated, still works)
data, err := ConfigRegistry.Library().Foundry().SimilarityFixtures()
```

The deprecated method now internally redirects to the new path, maintaining backward compatibility.

#### Module Registry Update

Updated `config/taxonomy/library/platform-modules/v1.1.0/modules.yaml`:

```yaml
- module_name: similarity
  evidence:
    schema_path: schemas/library/similarity/v2.0.0/ # was: foundry/v2.0.0/
    config_path: config/library/similarity/fixtures.yaml # was: foundry/similarity-fixtures.yaml
```

#### Documentation Updates

- Removed "Foundry" from title in `docs/standards/library/similarity/similarity.md`
- Removed "foundry" tag from document metadata
- Updated `$schema` reference in fixtures file

### Fixed

#### Python Exit Codes Path Alignment

Fixed codegen output path for Python exit codes to match the pattern used by other languages:

| Language   | Codegen Output Path                              | Pattern                                                |
| ---------- | ------------------------------------------------ | ------------------------------------------------------ |
| TypeScript | `lang/typescript/src/foundry/exitCodes.ts`       | `src/foundry/`                                         |
| Rust       | `lang/rust/src/foundry/exit_codes.rs`            | `src/foundry/`                                         |
| Python     | `lang/python/src/crucible/foundry/exit_codes.py` | `src/crucible/foundry/` (was: `src/pyfulmen/foundry/`) |
| Go         | `foundry/exit_codes.go`                          | (embeds, different pattern)                            |

**Why**: The Python exit codes were being generated to `lang/python/src/pyfulmen/foundry/` which:

- Used a legacy `pyfulmen` namespace instead of `crucible`
- Was inconsistent with other Python modules (`fulencode`, `fulhash`, `fulpack`) which use `src/crucible/`
- Required manual copying by pyfulmen consumers since the path didn't match their package structure

**Changes**:

- Updated `scripts/codegen/exit-codes/metadata.json` Python output path
- Created `lang/python/src/crucible/foundry/` module with proper `__init__.py`
- Removed legacy `lang/python/src/pyfulmen/` directory tree

## Commits

```
fd997c2 refactor(similarity): relocate from foundry to standalone module
```

## Impact

### For gofulmen

The embed directive now expects files at the new paths. Update any direct file references:

```go
// Before
//go:embed config/library/foundry/similarity-fixtures.yaml

// After
//go:embed config/library/similarity/fixtures.yaml
```

### For pyfulmen

The `foundry` module (including `exit_codes`) is now generated at `lang/python/src/crucible/foundry/` instead of `lang/python/src/pyfulmen/foundry/`. This aligns with the package structure used by other modules (`fulencode`, `fulhash`, `fulpack`).

Import path changes:

```python
# Before
from pyfulmen.foundry.exit_codes import EXIT_CODES

# After
from crucible.foundry.exit_codes import EXIT_CODES
```

### For Other Helper Libraries

- rsfulmen, tsfulmen: Sync will pick up new paths automatically
- Schema `$id` changes may affect offline resolver configurations

### Deprecation Notice

`ConfigRegistry.Library().Foundry().SimilarityFixtures()` is deprecated and will be removed in v0.5.0. Update to use `ConfigRegistry.Library().Similarity().Fixtures()`.

## Upgrade Notes

No breaking changes if using the Go config registry API (deprecated method still works).

If accessing files directly by path:

1. Update paths from `foundry/similarity-*` to `similarity/`
2. Update any `$schema` references in YAML files
3. Update embed directives if applicable

## Cross-References

- v0.4.0 Release Notes: [release-notes/v0.4.0.md](v0.4.0.md)
- Similarity Standard: `docs/standards/library/similarity/similarity.md`
- Module Registry: `config/taxonomy/library/platform-modules/v1.1.0/modules.yaml`
- Similarity Fixtures: `config/library/similarity/fixtures.yaml`
