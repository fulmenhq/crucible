# v0.4.9 - JSON Schema Meta-Schema Expansion

Expands crucible's meta-schema catalog to support all major JSON Schema drafts, enabling offline validation of legacy schemas and alignment with goneat v0.5.2.

## Added

- **Draft-04 Meta-Schema**: `schemas/meta/draft-04/schema.json`
  - Single-file, self-contained meta-schema
  - Uses `id` instead of `$id` (pre-Draft-06 convention)
  - Common in SchemaStore and legacy tooling

- **Draft-06 Meta-Schema**: `schemas/meta/draft-06/schema.json`
  - Single-file, self-contained meta-schema
  - Introduced `$id`, `const`, `contains`, `propertyNames`
  - Boolean schemas allowed (`true`/`false` as schemas)

- **Draft 2019-09 Meta-Schema**: `schemas/meta/draft-2019-09/`
  - `schema.json` - Canonical with `$ref` to modular vocabularies
  - `offline.schema.json` - Subset for offline validation (no external refs)
  - Uses `$recursiveAnchor`/`$recursiveRef` (replaced by `$dynamicAnchor` in 2020-12)
  - Introduced `$vocabulary`, `$anchor`, `unevaluatedProperties`, `unevaluatedItems`

- **Updated Documentation**: `schemas/meta/README.md`
  - Draft selection guidance table
  - Detailed descriptions of each draft's characteristics
  - Offline validation strategy notes

## Helper Library Implementation

This release enables helper libraries (gofulmen, tsfulmen, pyfulmen, rsfulmen) to implement a `MetaSchemaRegistry` API:

```go
// Go example
type MetaSchemaRegistry interface {
    ListDrafts() []string                          // ["draft-04", "draft-06", ...]
    GetMetaSchema(draft string) ([]byte, error)    // Load meta-schema content
    GetOfflineMetaSchema(draft string) ([]byte, error)
    DetectDraft(schema []byte) (string, error)     // Detect from $schema field
}
```

See `.plans/active/v0.4.9/001-jsonschema-meta-expansion-feature-brief.md` for full implementation guidance including:

- Draft detection vocabulary
- Offline validation mode
- Validator integration (AJV, gojsonschema, jsonschema)
- Testing requirements

## Draft Coverage

| Draft         | `$schema` URI                                  | Offline Support        |
| ------------- | ---------------------------------------------- | ---------------------- |
| Draft-04      | `http://json-schema.org/draft-04/schema#`      | Inherent (single-file) |
| Draft-06      | `http://json-schema.org/draft-06/schema#`      | Inherent (single-file) |
| Draft-07      | `http://json-schema.org/draft-07/schema#`      | Inherent (single-file) |
| Draft 2019-09 | `https://json-schema.org/draft/2019-09/schema` | `offline.schema.json`  |
| Draft 2020-12 | `https://json-schema.org/draft/2020-12/schema` | `offline.schema.json`  |

## Background

This change aligns with goneat v0.5.2's meta-schema expansion, which was driven by dogfooding on SchemaStore where many schemas still use Draft-04. By having crucible as the SSOT for meta-schemas:

1. Helper libraries embed consistent meta-schema copies
2. goneat can eventually consume from crucible instead of internal assets
3. Applications have deterministic offline validation across languages
