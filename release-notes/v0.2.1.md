# Release Notes: v0.2.1

**Date:** 2025-10-29

Patch release completing the Go module embedding implementation from v0.2.0 by adding the missing `config/` directory embedding. This enables downstream libraries (gofulmen, etc.) to access Crucible configuration files directly without requiring sync operations, maintaining true SSOT compliance.

## Highlights

- **Config Embedding**: Added `//go:embed config` completing the ADR-0009 implementation
- **Config Registry API**: New type-safe accessors for all embedded configuration files
- **SSOT Compliance**: Downstream consumers can now access all Crucible assets (schemas, docs, config) directly from the module
- **Comprehensive Tests**: Full test coverage for config embedding with 12 new test cases

## What's Fixed

### Missing config/ Embedding

**Issue**: v0.2.0 moved the Go module to root and added `//go:embed schemas` and `//go:embed docs`, but forgot to add `//go:embed config`. This forced downstream libraries like gofulmen to continue using sync scripts to duplicate config files instead of accessing them directly from Crucible.

**Fixed**: Added complete config embedding with type-safe accessor API.

## New API

### ConfigRegistry

Type-safe access to embedded configuration files:

```go
import "github.com/fulmenhq/crucible"

// Foundry catalog configs
patterns, err := crucible.ConfigRegistry.Library().Foundry().Patterns()
countryCodes, err := crucible.ConfigRegistry.Library().Foundry().CountryCodes()
httpStatuses, err := crucible.ConfigRegistry.Library().Foundry().HTTPStatuses()
mimeTypes, err := crucible.ConfigRegistry.Library().Foundry().MIMETypes()
fixtures, err := crucible.ConfigRegistry.Library().Foundry().SimilarityFixtures()

// FulHash module configs
fulhashFixtures, err := crucible.ConfigRegistry.Library().FulHash().Fixtures()

// Library module manifest
manifest, err := crucible.ConfigRegistry.Library().Manifest()

// Taxonomy configs
metrics, err := crucible.ConfigRegistry.Taxonomy().Metrics()
languages, err := crucible.ConfigRegistry.Taxonomy().Languages()
categories, err := crucible.ConfigRegistry.Taxonomy().RepositoryCategories()

// Terminal configs
overrides, err := crucible.ConfigRegistry.Terminal().OverridesDefaults()

// Sync configs
syncKeys, err := crucible.ConfigRegistry.Sync().SyncKeys()

// Generic accessors
data, err := crucible.GetConfig("library/foundry/patterns.yaml")
files, err := crucible.ListConfigs("library/foundry")
```

### Available Configuration Files

All config files are now embedded and accessible:

**Library Configs**:

- `config/library/foundry/patterns.yaml` - Validation patterns (email, UUID, etc.)
- `config/library/foundry/country-codes.yaml` - ISO country code catalog
- `config/library/foundry/http-statuses.yaml` - HTTP status code catalog
- `config/library/foundry/mime-types.yaml` - MIME type catalog
- `config/library/foundry/similarity-fixtures.yaml` - Text similarity test fixtures
- `config/library/fulhash/fixtures.yaml` - Hashing test fixtures
- `config/library/v1.0.0/module-manifest.yaml` - Library module manifest

**Taxonomy Configs**:

- `config/taxonomy/metrics.yaml` - Metrics taxonomy
- `config/taxonomy/languages.yaml` - Programming languages taxonomy
- `config/taxonomy/repository-categories.yaml` - Repository categories

**Terminal Configs**:

- `config/terminal/v1.0.0/terminal-overrides-defaults.yaml` - Terminal emoji width defaults

**Sync Configs**:

- `config/sync/sync-keys.yaml` - SSOT sync keys

## For Downstream Consumers

### gofulmen Migration Path

**Before (v0.2.0)** - Required sync:

```bash
# gofulmen had to sync config files
make sync  # Pulls config from Crucible repo
make sync-foundry-assets  # Copies to foundry/assets/
# foundry/catalog.go embeds local assets via //go:embed assets/*.yaml
```

**After (v0.2.1+)** - Direct access:

```go
// gofulmen can access config directly from Crucible module
import "github.com/fulmenhq/crucible"

func LoadPatterns() (map[string]*Pattern, error) {
    data, err := crucible.ConfigRegistry.Library().Foundry().Patterns()
    if err != nil {
        return nil, err
    }
    // ... parse YAML
}
```

**Benefits**:

- ✅ No sync required
- ✅ No config duplication
- ✅ Version alignment automatic (config version matches Crucible go.mod version)
- ✅ Single source of truth maintained
- ✅ Simpler build process

**Note**: gofulmen v0.1.6 ships with the old sync-based approach (works correctly). Future gofulmen version will migrate to direct config access.

## Migration

### Update Dependency

```bash
go get github.com/fulmenhq/crucible@v0.2.1
go mod tidy
```

### No Breaking Changes

This is a **backward-compatible addition**:

- Existing code continues to work
- New ConfigRegistry API available for use
- Can migrate to direct config access at your convenience

## Validation

**All quality gates passed**:

- ✅ Go tests: 22/22 passed (10 new config tests)
- ✅ TypeScript tests: 12/12 passed
- ✅ Python tests: 10/10 passed
- ✅ Config embedding: All 12 config files verified accessible
- ✅ Schema validation: All schemas valid
- ✅ Lint: All languages passed
- ✅ Typecheck: TypeScript type checking passed
- ✅ Precommit/prepush: All checks passed

## Files Changed

**Added**:

- `config.go` - Config embedding and accessor API (164 lines)
- `config_test.go` - Comprehensive config tests (12 test cases)

**Updated**:

- `VERSION` - 0.2.0 → 0.2.1
- `CHANGELOG.md` - v0.2.1 entry
- Package versions (package.json, pyproject.toml) - Synced to 0.2.1

## Related

- [ADR-0009: Go Module Root Relocation](../docs/architecture/decisions/ADR-0009-go-module-root-relocation.md) - Context for module structure
- [ADR-0010: Semantic Versioning Adoption](../docs/architecture/decisions/ADR-0010-semantic-versioning-adoption.md) - Versioning decision
- [gofulmen memo: Config Embedding Missing](https://github.com/fulmenhq/gofulmen/.plans/memos/crucible/2025-10-29-config-embedding-missing.md) - Issue discovery

## Credits

**Identified by**: Foundation Forge (gofulmen team)
**Implementation**: Schema Cartographer (supervised by @3leapsdave)
**Review**: @3leapsdave

---

For questions or issues, see the [CHANGELOG](../CHANGELOG.md) or open an issue on GitHub.
