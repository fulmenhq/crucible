---
title: "Crucible Release Checklist"
status: "approved"
author: "Pipeline Architect"
last_updated: "2025-10-17"
category: "ops/repository"
---

# Crucible Release Checklist

**Purpose**: Crucible-specific release workflow ensuring SSOT integrity, quality gates, and proper versioning before tagging and pushing.

**Scope**: This checklist is specific to Crucible repository releases. For general FulmenHQ release standards, see [Release Checklist Standard](../../standards/release-checklist-standard.md).

---

## Release Workflow

### Phase 1: Pre-Release Preparation

#### 1.1 Verify Clean State

```bash
git status
git branch --show-current
```

**Verify**:

- [ ] On `main` branch
- [ ] Working tree is clean (no uncommitted changes)
- [ ] All intended commits are present
- [ ] No `.plans/` files accidentally staged

#### 1.2 Review Release Scope

```bash
git log v$(cat VERSION)..HEAD --oneline
```

**If this is first release or VERSION file doesn't exist**:

```bash
git log --oneline
```

**Verify**:

- [ ] All commits since last release reviewed
- [ ] Commit messages follow attribution standards
- [ ] No WIP or debug commits
- [ ] Breaking changes documented

#### 1.3 Update VERSION File

**Semantic Versioning (current strategy)**:

```bash
make version-set VERSION=0.2.26
```

Or bump via Make targets:

```bash
make version-bump-patch   # 1.0.0 → 1.0.1
make version-bump-minor   # 1.0.1 → 1.1.0
make version-bump-major   # 1.1.0 → 2.0.0
```

**Verify**:

- [ ] VERSION file updated
- [ ] Version follows project versioning standard
- [ ] Version matches release notes (if created)
- [ ] Versioning aligns with [ADR-0010](../../architecture/decisions/ADR-0010-semantic-versioning-adoption.md)

#### 1.4 Update Release Notes (if applicable)

```bash
# Create or update release notes in release-notes/
vim release-notes/$(cat VERSION).md
```

**Verify**:

- [ ] Release notes created/updated
- [ ] Breaking changes documented
- [ ] Migration guide included (if needed)

### Phase 2: Quality Gates (REQUIRED)

#### 2.1 Run Pre-Push Checks

```bash
make prepush
```

**This runs**:

- Schema validation
- Code generation verification (verify-codegen)
- SSOT sync to language wrappers
- Linting (TypeScript, Python, Go, YAML)
- Formatting (all file types)
- All test suites
- Type checking
- Coverage validation

**Verify**:

- [ ] All quality gates pass (exit code 0)
- [ ] No test failures
- [ ] No linting errors
- [ ] Coverage meets thresholds
- [ ] All language wrappers synced

#### 2.2 Verify SSOT Synchronization

```bash
git status
```

**CRITICAL FOR CRUCIBLE**: All language wrappers must be current.

**Verify**:

- [ ] `lang/go/docs/`, `lang/go/schemas/`, `lang/go/config/` current
- [ ] `lang/typescript/docs/`, `lang/typescript/schemas/`, `lang/typescript/config/` current
- [ ] `lang/python/docs/`, `lang/python/schemas/`, `lang/python/config/` current
- [ ] No sync-related files modified after prepush

**If files are modified**:

```bash
make sync
git status
# If files changed, commit them before release
```

#### 2.3 Run Release-Specific Checks

```bash
make release-check
```

**Verify**:

- [ ] Release checks pass
- [ ] No outstanding TODOs or FIXMEs blocking release
- [ ] Documentation is current

### Phase 3: Commit Release Changes

**If VERSION or release notes were updated**:

```bash
git add VERSION release-notes/$(cat VERSION).md
git commit -m "chore: prepare release $(cat VERSION)

Release preparation for version $(cat VERSION).

Generated by Pipeline Architect ([Claude Code](https://claude.com/claude-code)) under supervision of @3leapsdave

Co-Authored-By: Pipeline Architect <noreply@3leaps.net>
Committer-of-Record: Dave Thompson <dave.thompson@3leaps.net> [@3leapsdave]"
```

**Verify**:

- [ ] Commit successful
- [ ] Working tree clean
- [ ] Run `git log -1` to verify commit

### Phase 4: Create Tag

#### 4.1 Create Signed Annotated Tag (Required)

Ensure interactive GPG signing can prompt for passphrase (recommended):

```bash
export GPG_TTY="$(tty)"
gpg-connect-agent updatestartuptty /bye
```

Optional: use a dedicated signing keyring (recommended for org-wide release keys):

```bash
export FULMENHQ_CRUCIBLE_GPG_HOMEDIR=/path/to/gnupg-fulmenhq
export FULMENHQ_CRUCIBLE_PGP_KEY_ID="<key-id-or-email>" # optional; uses default git signing key if unset
```

Optional: enable minisign sidecar attestation (recommended when available):

```bash
export FULMENHQ_CRUCIBLE_MINISIGN_KEY=/path/to/fulmenhq.minisign.key
export FULMENHQ_CRUCIBLE_MINISIGN_PUB=/path/to/fulmenhq.minisign.pub
```

```bash
make release-guard-tag-version
make release-tag
```

**Verify**:

- [ ] Tag created successfully
- [ ] Tag name follows `v<VERSION>` format (must match `VERSION`)
- [ ] Tag is signed and verifies locally (`make release-verify-tag`)

#### 4.2 Verify Tag

```bash
make release-verify-tag

git tag -l "v*" | tail -5
git show v$(cat VERSION) --stat
```

**Verify**:

- [ ] Tag points to correct commit
- [ ] Tag message is correct
- [ ] No unexpected files in tagged commit

Optional: verify GitHub’s interpretation (CI-friendly; requires `gh` auth):

```bash
make release-verify-remote-tag
```

**Note (expected during key bootstrap)**:

- If GitHub reports `.verification.verified=false` with `.verification.reason="unknown_key"`, it usually means the release signing **public** key has not been uploaded to the GitHub release identity (or the tagger email doesn’t map to a verified email on that identity).
- This does **not** invalidate the cryptographic signature. The authoritative check remains local: `make release-verify-tag` / `git tag -v v<VERSION>`.
- Do **not** rewrite/retag already-published versions just to “make GitHub green”; fix the key visibility and let future tags verify in GitHub UI/API.

### Phase 5: Push to Remote (REQUIRES APPROVAL)

**⚠️ IMPORTANT**: Get explicit approval from @3leapsdave before pushing to main.

#### 5.1 Dry Run Push

```bash
git push --dry-run origin main
git push --dry-run origin v$(cat VERSION)
```

**Verify**:

- [ ] Dry run shows expected refs
- [ ] No unexpected commits being pushed
- [ ] Tag push looks correct

#### 5.2 Push Commits

```bash
git push origin main
```

**Verify**:

- [ ] Push succeeded
- [ ] Check GitHub web UI for commits
- [ ] CI/CD triggered (if configured)

#### 5.3 Push Tag

```bash
git push origin v$(cat VERSION)
```

**Verify**:

- [ ] Tag push succeeded
- [ ] Check GitHub releases page
- [ ] Tag visible in web UI

### Phase 6: Post-Release

#### 6.1 Verify Remote State

```bash
git fetch origin
git log origin/main -3
git tag -l "v*" | tail -3
```

**Verify**:

- [ ] Local and remote are in sync
- [ ] Tag visible remotely
- [ ] No divergence

#### 6.2 Create GitHub Release (if applicable)

**Manual steps**:

1. Go to GitHub releases page
2. Draft new release from tag `v$(cat VERSION)`
3. Paste contents of `release-notes/$(cat VERSION).md`
4. Attach any artifacts (if applicable)
5. Publish release

**Verify**:

- [ ] GitHub release created
- [ ] Release notes visible
- [ ] Assets attached (if applicable)

#### 6.3 Notify Downstream Consumers

**Notify maintainers of**:

- `gofulmen` - Pull Crucible updates
- `tsfulmen` - Pull Crucible updates
- `pyfulmen` - Pull Crucible updates

**Communication channels**:

- Mattermost: Post in `#fulmen-releases`
- GitHub: Tag maintainers in release notes

---

## Quick Reference

**Minimum Required Steps**:

1. Verify clean state and review commits
2. Update VERSION: `make version-set VERSION=<version>`
3. Run quality gates: `make prepush`
4. Verify sync: `git status`
5. Commit version changes (if any)
6. Create signed tag: `make release-tag`
7. **Get approval from @3leapsdave**
8. Push: `git push origin main && git push origin v$(cat VERSION)`
9. Create GitHub release
10. Notify downstream consumers

---

## Emergency Rollback

**If release has issues AFTER push**:

### Option 1: Revert Commits (Preferred)

```bash
git revert <commit-sha>
git push origin main
```

### Option 2: Delete Tag (If Not Published)

```bash
git tag -d v<version>
git push origin :refs/tags/v<version>
```

**⚠️ WARNING**: Only delete tags that haven't been pulled by consumers.

### Option 3: Create Patch Release

```bash
# Fix the issue
make version-set VERSION=<next-patch-version>
# Follow release checklist again
```

---

## Common Issues

### Sync Files Modified After prepush

**Symptom**: `git status` shows modified files after `make prepush`

**Fix**: Sync ran during prepush, commit the changes

```bash
git add .
git commit -m "chore: sync language wrappers for release"
```

### Tag Already Exists

**Symptom**: `git tag` fails with "already exists"

**Fix**: Delete and recreate (if not pushed)

```bash
git tag -d v$(cat VERSION)
make release-tag
```

### Push Rejected

**Symptom**: `git push` fails with "rejected"

**Fix**: Pull and rebase (coordinate with team)

```bash
git pull --rebase origin main
# Re-run quality gates
make prepush
git push origin main
```

---

## Release Types

### Patch Release (0.2.25 → 0.2.26)

- Bug fixes
- Documentation updates
- No breaking changes
- Standard quality gates

### Minor Release (0.2.x → 0.3.0)

- New features
- Non-breaking schema additions
- Enhanced functionality
- Standard quality gates + integration tests

### Major Release (0.x.y → 1.0.0)

- Breaking changes
- Schema format changes
- Major refactors
- **Requires downstream coordination**
- Extended quality gates
- Migration guides required

---

## Related Documentation

- [Repository Operations SOP](../../sop/repository-operations-sop.md) - Global standards
- [Release Checklist Standard](../../standards/release-checklist-standard.md) - FulmenHQ standard
- [Commit Checklist](./commit-checklist.md) - Pre-commit workflow
- [Makefile Standard](../../standards/makefile-standard.md) - Available targets
- [AGENTS.md](../../../AGENTS.md) - Session startup and agent protocols

---

**Status**: Approved
**Last Updated**: 2025-10-17
**Author**: Pipeline Architect
**Effective Date**: 2025-10-17
