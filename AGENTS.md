# Crucible – AI Agents Startup Guide

## Read First

1. Check `AGENTS.local.md` if it exists (gitignored for local customization)
2. Read `MAINTAINERS.md` for contacts and governance
3. Read `REPOSITORY_SAFETY_PROTOCOLS.md` before executing sync, release, or destructive commands
4. Understand project scope before making changes

## Operating Model

| Aspect         | Setting                                  |
| -------------- | ---------------------------------------- |
| Mode           | Supervised (human reviews before commit) |
| Classification | Security-sensitive                       |
| Role Required  | Yes                                      |

See [agent-identity patterns](docs/standards/ai-agents.md) for operating modes and [attribution baseline](docs/catalog/agentic/attribution/git-commit.md) for commit format.

## Roles

| Role       | Prompt                                              | Notes               |
| ---------- | --------------------------------------------------- | ------------------- |
| `devlead`  | [devlead.yaml](config/agentic/roles/devlead.yaml)   | Implementation      |
| `devrev`   | [devrev.yaml](config/agentic/roles/devrev.yaml)     | Four-eyes review    |
| `infoarch` | [infoarch.yaml](config/agentic/roles/infoarch.yaml) | Docs, schemas       |
| `entarch`  | [entarch.yaml](config/agentic/roles/entarch.yaml)   | Cross-repo arch     |
| `cicd`     | [cicd.yaml](config/agentic/roles/cicd.yaml)         | Pipelines, builds   |
| `secrev`   | [secrev.yaml](config/agentic/roles/secrev.yaml)     | Security analysis   |
| `dataeng`  | [dataeng.yaml](config/agentic/roles/dataeng.yaml)   | Data infrastructure |

See [Role Catalog](config/agentic/roles/README.md) for full role definitions and customization patterns.

## Project Overview

**Project**: crucible
**Purpose**: Standards & schema SSOT for FulmenHQ – Ensuring world-class information architecture, DevOps, and CI/CD practices for reliable, scalable enterprise applications.
**Governance**: 3leaps Initiative

**Quality Focus**: As part of the FulmenHQ ecosystem, designed for extremely high-scale enterprise-class applications, all actions must emphasize code quality, process compliance, and system reliability. Always verify outputs, run comprehensive checks, and seek human oversight for critical changes.

## Quick Reference

| Task                           | Command                      | Documentation                                                      |
| ------------------------------ | ---------------------------- | ------------------------------------------------------------------ |
| Pre-commit workflow            | `make precommit`             | [Commit Checklist](docs/ops/repository/commit-checklist.md)        |
| Pre-release workflow           | `make prepush`               | [Release Checklist](docs/ops/repository/release-checklist.md)      |
| Sync SSOT to language wrappers | `make sync`                  | [Makefile](Makefile)                                               |
| Format code                    | `make fmt`                   | [Makefile Standard](docs/standards/makefile-standard.md)           |
| Run tests                      | `make test`                  | [Makefile](Makefile)                                               |
| Run all quality gates          | `make check-all`             | [Repository Operations SOP](docs/sop/repository-operations-sop.md) |
| Update version                 | `make version-set VERSION=x` | [Makefile Standard](docs/standards/makefile-standard.md)           |

## Commit Attribution

Follow the [Git Commit Attribution Baseline](docs/catalog/agentic/attribution/git-commit.md).

**Required elements**:

1. `Generated by` line with Model, Interface, and supervisor
2. `Co-Authored-By:` trailer with model name and `noreply@3leaps.net`
3. `Role:` trailer with the role being operated as
4. `Committer-of-Record:` trailer with human maintainer info

**Example** (using Claude Code with entarch role):

```
feat(catalog): add agent role definitions

Introduces role catalog with baseline prompts for development,
review, and infrastructure roles.

Changes:
- Add docs/catalog/agentic/roles/ directory structure
- Create devlead, devrev, infoarch role prompts
- Add README with usage patterns and customization guide

Generated by Claude Opus 4.5 via Claude Code under supervision of @3leapsdave

Co-Authored-By: Claude Opus 4.5 <noreply@3leaps.net>
Role: entarch
Committer-of-Record: Dave Thompson <dave.thompson@3leaps.net> [@3leapsdave]
```

### Attribution Quick Reference

| Element             | Correct                            | Wrong                    |
| ------------------- | ---------------------------------- | ------------------------ |
| Model name          | `Claude Opus 4.5`, `Claude Sonnet` | `Claude`, `AI Assistant` |
| Email               | `noreply@3leaps.net`               | `noreply@anthropic.com`  |
| Role                | `devlead`, `entarch`, `infoarch`   | (missing)                |
| Committer-of-Record | Required                           | (missing)                |

## Interface Adapters

| Agentic Interface | Config File                | Notes                    |
| ----------------- | -------------------------- | ------------------------ |
| Claude Code       | `CLAUDE.md` or `AGENTS.md` | Primary                  |
| Codex CLI         | `CODEX.md`                 |                          |
| Cursor            | `AGENTS.md`                |                          |
| Cline             | `.cline/rules/PROJECT.md`  | Must reference AGENTS.md |
| OpenCode          | `AGENTS.md`                |                          |

## Session Protocol

### Before Changes

1. **Context Review**
   - Read `MAINTAINERS.md`, `REPOSITORY_SAFETY_PROTOCOLS.md`
   - Read `Makefile` to understand sync patterns
   - Understand that `lang/*/docs/`, `lang/*/schemas/`, `lang/*/config/` are synced FROM root SSOT

2. **Environment Check**
   - Confirm required tools (`bun >= 1.2`, `go >= 1.21`)
   - Run `make bootstrap` if tools are missing

3. **Plan**
   - Outline steps in `.plans/` (gitignored) before modifying files

### Before Committing

1. Run `make precommit` (includes sync, format, lint, test)
2. Run `git status` to verify all changes staged
3. Use proper attribution with `Role:` trailer
4. Include `Committer-of-Record` trailer

## DO / DO NOT

### DO

- **Quality First**: Run `make precommit` before staging files
- **Use Make Targets**: Prefer `make lint`, `make test`, `make check-all`
- **SSOT Discipline**: Modify schemas/docs at root, then `make sync`
- **Sync Before Changes**: Run `make sync` to ensure wrappers are current
- **Document Changes**: Maintain clear documentation
- **Version Management**: Use `make version-set VERSION=x`

### DO NOT

- **Edit Synced Files**: Never edit `lang/*/docs/`, `lang/*/schemas/`, `lang/*/config/` directly
- **Edit Upstream Schemas**: Never edit `schemas/upstream/` – these are vendored from external repos (see [PROVENANCE.md](schemas/upstream/3leaps/PROVENANCE.md))
- **Commit Planning Files**: `.plans/` is gitignored
- **Direct Releases**: Tagging/publishing requires approval from @3leapsdave
- **Store Secrets**: Never commit API keys, tokens, or credentials
- **Skip Quality Gates**: Never commit without running `make precommit`
- **Modify VERSION Directly**: Use Make targets
- **Break Downstream Consumers**: Crucible is SSOT for multiple projects

## Crucible-Specific Workflows

### Pre-Commit Workflow

Follow [`docs/ops/repository/commit-checklist.md`](docs/ops/repository/commit-checklist.md):

```bash
make precommit          # Quality gates + sync
git status              # Verify sync completed
git add .               # Stage all files
git commit              # With proper attribution
```

### Pre-Release Workflow

Follow [`docs/ops/repository/release-checklist.md`](docs/ops/repository/release-checklist.md):

```bash
make prepush                          # Comprehensive checks
make version-set VERSION=<version>    # Update version
git tag -a v$(cat VERSION)            # After approval
git push origin main
git push origin v$(cat VERSION)
```

## Reference Documents

- [MAINTAINERS.md](MAINTAINERS.md) - Human maintainers and governance
- [REPOSITORY_SAFETY_PROTOCOLS.md](REPOSITORY_SAFETY_PROTOCOLS.md) - Safety guardrails
- [Role Catalog](config/agentic/roles/README.md) - Role definitions (YAML)
- [Git Commit Attribution](docs/catalog/agentic/attribution/git-commit.md) - Commit format
- [Agent Identity Standard](docs/standards/ai-agents.md) - Operating modes
- [Agentic Attribution Standard](docs/standards/agentic-attribution.md) - Full attribution spec
